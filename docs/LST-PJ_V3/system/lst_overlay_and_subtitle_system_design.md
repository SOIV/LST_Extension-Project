# Live Stream Translator (LST)

## Overlay & Subtitle System Design Summary

본 문서는 LST 확장 프로그램 설계 과정에서 논의된 **오버레이 UI**, **자막 분할 로직**, **롱 자막 방지 전략**, **학습 보조 기능**을 정리한 설계 요약 문서이다.

---

## 1. 오버레이 기본 철학

- 목적: **실시간 시청 방해 최소화 + 선택적 학습 보조**
- 기본 사용자 기준 강조 우선순위:
  1. 번역된 한국어 (의미)
  2. 한국어 발음 (학습용, 선택)
  3. 원어 일본어 (참조용)

---

## 2. 기본 오버레이 구성 (단일 화자 기준)

### 표시 영역

- 상단: 원어 일본어
- 중단: 한국어 발음 (옵션)
- 하단: 번역된 한국어 (메인)

### 텍스트 크기 예시

- 원어: 30
- 번역: 30
- 발음: 15 ~ 20

### 디자인 원칙

- 번역 영역이 가장 눈에 띄도록 강조
- 발음은 흐린 색상 + 얇은 폰트
- 원어는 참조용으로 유지

---

## 3. 후리가나(루비) 및 한자 표시 정책

### 기본값

- 한자 미표시
- 전부 히라가나 / 가타카나로 출력

### 옵션 ON (베타)

- 히라가나
- 가타카나
- 한자 + 후리가나

※ 완성도 확보 전까지는 **베타 옵션**으로 제공

---

## 4. 다중 화자 대응 전략

### 기본 전략

- 원어 및 한국어 발음: **콘솔 로그 출력**
- 오버레이: 번역 영역만 사용

### 번역 표시 방식 예시

```
- A: 다음 정보 소개해 주세요.
- B: 네! 다음 정보는 000입니다!
```

### 확장 옵션 (고급)

- 다중 화자 수 사용자 설정
- 자유 오버레이 활성화
- 드래그로 위치 지정
- 프리셋 기반 레이아웃 저장

---

## 5. 자막 배경 표시 옵션

- 옵션 A: 연한 회색 배경 (불투명도 약 75%)
- 옵션 B: 사각 박스 배경
- 프리셋 기반 제공:
  - 기본
  - 고대비
  - 투명
  - 커스텀

---

## 6. 한국어 발음 표시 정책

- 목적: JLPT 및 일본어 학습 보조
- 기본값: OFF
- 설정에서 ON/OFF 가능
- 학습 모드에서만 활성화 권장

---

## 7. 자막 분할 시스템 설계 (핵심)

### 설계 목표

- 롱 자막 발생 원천 차단
- 중간 결과 출력 방지
- 시스템 안정성 확보

---

## 8. 자막 처리 파이프라인 구조

```
STT
 ↓
Segment Buffer
 ↓ (commit 조건 만족)
Translation Queue
 ↓
Render Queue
```

- 각 단계는 완전히 분리
- 번역 지연이나 STT 흔들림이 UI에 직접 영향 주지 않음

---

## 9. 자막 컷(분할) 기준 우선순위

### 1순위: 대화 내용 기반 컷

- 종결 표현 감지:
  - です / ます / だよ / ですね / でした 등
- 의미 단위 완결 시 즉시 commit
- 중간 끊김도 의미 완결로 판단 가능

---

### 2순위: 시간 / 침묵 기반 컷

- 일정 시간 이상 종결 없음
- 침묵 감지 시 문장 확정
- 예: 250~500ms 침묵

---

### 3순위: 텍스트 수 기반 컷 (최후 안전장치)

- 기본값 예시: 50 ~ 100자
- 위 조건이 모두 실패했을 때만 발동
- 롱 자막 물리적 방지용

---

## 10. 롱 자막 방지 3중 안전장치

1. 최대 글자 수 제한
2. 최대 대기 시간 제한
3. 종결 표현 감지

※ 하나라도 없으면 언젠가 롱 자막 문제 발생

---

## 11. 중간 인식 결과 처리 정책

- partial STT 결과 화면 출력 ❌
- 화면에는 확정(commit)된 문장만 표시
- 중간 결과 출력은 베타 옵션으로도 비권장

---

## 12. 이전 자막 히스토리 표시 (UX 개선)

- 현재 자막 위에 이전 자막 1줄 표시
- 크기: 약 60%
- 불투명도: 40~50%
- 일정 시간 후 자동 제거

효과:
- 빠른 대화 흐름 이해도 증가
- 강제 컷으로 인한 의미 손실 보완

---

## 13. 핵심 설계 원칙 요약 (TOP 5)

- partial STT 화면 미출력
- 문장 확정(commit) 기준 명확화
- 대화 기반 컷 우선
- 텍스트 컷은 최후 안전장치
- 번역 큐와 렌더 큐 분리

---

## 14. 한 문장으로 요약한 LST 자막 철학

> 의미가 끝나면 자르고,
> 의미 판단이 애매하면 기다리고,
> 그래도 안 끝나면 강제로 자른다.

---

## 15. 단어장 / 교정 사전 기능 설계

### 목적

- 애니메이션, 게임, 고유명사, 전문 용어 등 **일반 번역기로 정확히 처리하기 어려운 표현 보정**
- 방송 맥락에 맞는 일관된 번역 제공
- 학습용 사용자에게 용어 대응 관계 명확화

---

### 기본 제공 사전

- 일본어 기본 단어장 / 교정 사전
- 영어 기본 단어장 / 교정 사전

포함 범위:
- 애니메이션·게임에서 자주 등장하는 표현
- 고유명사(캐릭터, 시스템 명칭 등)
- 번역기 오역 빈도가 높은 패턴

---

### 사용자 커스텀 단어장

사용자는 직접 단어장 / 교정 사전을 생성하여 적용할 수 있다.

#### 확장 프로그램

- Google Sheets 기반 단어장
- 공유 링크(URL) 등록 방식
- 실시간 수정 반영 가능

#### 데스크탑 앱

- TXT 파일 로드
- Google Sheets 링크 등록 지원

---

### 단어장 기본 구조 예시

| 원어  | 교정 번역 | 발음(선택) | 비고       |
| --- | ----- | ------ | -------- |
| 必殺技 | 필살기   | 히사츠와자  | 애니/게임 용어 |

---

### 적용 우선순위

1. 사용자 커스텀 단어장
2. 프로젝트 기본 제공 교정 사전
3. 일반 번역 결과

---

### 시스템 적용 방식

- 번역 전/후 교정 단계 분리
- 완전 치환 방식 우선 적용
- 부분 매칭은 옵션으로 제공

---

### 관리 및 UX 정책

- 단어장 ON/OFF 가능
- 사전별 활성화 선택 가능
- 베타 기능으로 단계적 확장 가능

---

### 향후 확장 가능 요소

- 프로젝트별 단어장 프리셋
- 방송별 단어장 자동 전환
- 커뮤니티 공유 단어장(선별적)

---

본 문서는 추후 UI 변경, 옵션 확장, 베타 기능 추가에 따라 수정될 수 있다.